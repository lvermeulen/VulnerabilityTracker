using System.Threading.Tasks;
using Vulnerabilities.Sources.OssIndex;
using Xunit;

namespace Vulnerabilities.Core.Tests
{
    public class VulnerabilityCheckShould
    {
        private readonly VulnerabilityCheck _check;

        public VulnerabilityCheckShould()
        {
            _check = new VulnerabilityCheck();
        }

        [Theory]
        [InlineData(DependencyManagerTypes.NuGet, "jquery", "2.0.0")]
        public async Task ExecuteAsync(DependencyManagerTypes dependencyManager, string dependencyName, string dependencyVersion)
        {
            _check.AddSource(dependencyManager, new OssIndexVulnerabilitySource("https://ossindex.sonatype.org"));
            var results = await _check.ExecuteAsync(dependencyName, dependencyVersion);
            Assert.NotEmpty(results);
        }
    }
}
